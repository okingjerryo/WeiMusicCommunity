<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.test.Login">
    <select id="selLoginWithAccName" parameterType="string" resultType="Login">
        SELECT * FROM UserLogin WHERE UAName = #{thisUserName}
    </select>
    <select id="selLoginWithMailName" parameterType="string" resultType="Login">
        SELECT * FROM UserLogin WHERE UMail = #{thisUserName}
    </select>
    <select id="selLoginWithTelName" parameterType="string" resultType="Login">
        SELECT * FROM UserLogin WHERE UTel = #{thisUserName}
    </select>
    <select id="selLoginWithUUuid" parameterType="string" resultType="Login">
        select * from UserLogin WHERE UUuid = #{UUuid};
    </select>
    <insert id="registeUser" parameterType="Login" flushCache="true">
        INSERT INTO UserLogin (UUuid,UPwd,UAName,UTel,UMail)
        VALUES (#{UUuid},#{UPwd},#{UAName},#{UTel},#{UMail})
    </insert>

    <insert id="insertFreqTOWork" parameterType="UserTFWork" flushCache="true">
        INSERT INTO UserWork (UWid,UUuid,WorkId,isFreq)
        VALUES (#{UWid},#{UUuid},#{WorkId},#{isFreq})
    </insert>
    <insert id="regist_insertUserExtend" parameterType="UserExtend" flushCache="true" >
        INSERT INTO UserExtend (UUuid,UNackName,USex,UBirthday,USign,UHeadImg)
        VALUES (#{UUuid},#{UNackName},#{USex},#{UBirthday},#{USign},#{UHeadImg})
    </insert>

    <update id="update_LoginAll" parameterType="Login" flushCache="true">
        UPDATE UserLogin set UPwd=#{UPwd},UAName=#{UAName},UTel=#{UTel},UMail=#{UMail} WHERE UUuid = #{UUuid}
    </update>
    <select id="selUserExtendByUUuid" parameterType="string" resultType="UserExtend">
        SELECT * FROM UserExtend WHERE UUuid = #{thisUUid}
    </select>
    <update id="update_userExtendAll" parameterType="UserExtend" flushCache="true">
        UPDATE UserExtend set UNackName = #{UNackName},USex = #{USex},UBirthday = #{UBirthday},UTag = #{UTag},USign = #{USign},UHeadImg = #{UHeadImg}
        WHERE UUuid = #{UUuid}
    </update>
    <select id="sel_userTFWorkByUUuid" parameterType="string" resultType="UserTFWork">
        SELECT * FROM userworkview WHERE UUuid = #{UUuid}
    </select>
    <update id="update_ALineofTFWork" parameterType="UserTFWork" flushCache="true">
        UPDATE UserWork set WorkId = #{WorkId},isFreq = #{isFreq},status = #{status},delayTime = #{delayTime}
        WHERE UWid = #{UWid}
    </update>
    <delete id="delete_ALineofTFWork" parameterType="string" flushCache="true">
        DELETE FROM UserWork WHERE UWid = #{UWid}
    </delete>

    <select id="sel_CommityInfoByCName" parameterType="string" resultType="CommityInfo">
        SELECT * FROM CommityInfo WHERE CName = #{CName}
    </select>
    <insert id="insert_CommityInfo" parameterType="CommityInfo" flushCache="true">
        INSERT INTO CommityInfo (CId, CName, Cintroduce,CCreateTime, CTag, CHeadImg, CNMDemand, CMeMCount)
        VALUES (#{Cid},#{CName},#{Cintroduce},#{CCreateTime},#{CTag},#{CHeadImg},#{CNMDemand},0)
    </insert>
    <insert id="insert_CommityMember" parameterType="CommityMember" flushCache="true">
        INSERT INTO CommityMember (CMid, CId,UJoinTime, UUuid, Utype)
        VALUES (#{CMid},#{Cid},#{UJoinTime},#{UUuid},#{Utype})
    </insert>
    <select id="sel_CommityMemCount" parameterType="string" resultType="int">
        SELECT CMeMCount FROM CommityInfo WHERE CId = #{Cid}
    </select>
    <update id="update_CommmityMeMCount" parameterType="CommityInfo" flushCache="true">
        UPDATE CommityInfo SET CMeMCount = #{CMeMCount}
        WHERE CId = #{Cid}
    </update>
    <select id="sel_CommityUserByCId" parameterType="string" resultType="CommityMember">
        SELECT * FROM sel_commitymemview WHERE CId = #{Cid}
    </select>
    <select id="sel_CommityOneUserByCM" parameterType="CommityMember" resultType="CommityMember">
        SELECT * FROM CommityMember WHERE CId = #{Cid} AND UUuid = #{UUuid}
    </select>
    <update id="update_CommityMemType" parameterType="CommityMember" flushCache="true">
        UPDATE CommityMember SET Utype = #{Utype} WHERE UUuid = #{UUuid}
    </update>
    <delete id="del_CommityMem" parameterType="CommityMember" flushCache="true">
        DELETE FROM CommityMember WHERE CId = #{Cid} AND UUuid = #{UUuid}
    </delete>
    <select id="sel_CommityInfoByCid" parameterType="string" resultType="CommityInfo">
        SELECT *
        FROM CommityInfo
        WHERE CId = #{Cid}
    </select>
    <update id="update_CommityNotice" parameterType="CommityInfo" flushCache="true">
        UPDATE CommityInfo SET CNotice = #{CNotice},CNoteCTime = #{CNoteCTime}
        WHERE CId = #{Cid}
    </update>
    <insert id="insert_CommityActive" parameterType="CommityActive" flushCache="true">
        INSERT INTO CommityActive (CAId, Cid, CAStartTime, CAEndTime, CATitle, CAThings, CACreatUserId, CAImgPath)
        VALUES
            (CAId = #{CAId}, Cid = #{Cid}, CAStartTime = #{CAStartTime}, CAEndTime = #{CAEndTime}, CATitle = #{CATitle},
             CAThings = #{CAThings},
             CACreatUserId = #{CACreatUserId}, CAImgPath = #{CAImgPath})
    </insert>
    <update id="update_CommityInfo" parameterType="CommityInfo" flushCache="true">
        UPDATE CommityInfo
        SET CName = #{CName},CCreateTime = #{CCreateTime},Cintroduce = #{Cintroduce},CTag = #{CTag},CHeadImg =
        #{CHeadImg},CIsNMin = #{CIsNMin},CNMDemand = #{CNMDemand},
        CNotice = #{CNotice},CNoteCTime = #{CNoteCTime}
        WHERE CId = #{Cid}
    </update>
    <select id="sel_CommityMemByCMId" parameterType="string" resultType="CommityMember">
        SELECT *
        FROM sel_commitymemview
        WHERE CMid = #{CMId}
    </select>
    <select id="sel_getAllWork" resultType="Work">
        SELECT *
        FROM Work
    </select>
    <insert id="insert_ProjectCreate" parameterType="ProjectInfo" flushCache="true">
        INSERT INTO ProjectInfo (PId, CId, CreatUUuid, PTitle, PIntroduce, PCreatTime, PState, PType)
        VALUES (PId = #{PId}, CId = #{CId}, CreatUUuid = #{CreatUUuid}, PTitle = #{PTitle}, PIntroduce = #{PIntroduce},
        PCreatTime = #{PCreatTime}
        , PState = #{PState}, PType = #{PType})
    </insert>
    <insert id="insert_ProjectWork" parameterType="ProjectWork" flushCache="true">
        INSERT INTO ProjectWork (PWId, PId, UWid, UJoinTIme)
        VALUES (PWId = #{PWId}, PId = #{PId}, UWid = #{UWid}, UJoinTIme = #{UJoinTIme})
    </insert>
    <select id="sel_ProjectDynAfterIn" parameterType="ProjectDynamic" resultType="ProjectDynamic">
        SELECT *
        FROM sel_ProjectDynWithNoFile
        WHERE PDId = #{PDId}
    </select>
    <insert id="insert_DynWord" parameterType="string" flushCache="true">
        INSERT INTO ProjectDynamic (Word)
        VALUES (Word = #{Word})
    </insert>
    <select id="sel_getAllCommityProject" parameterType="ProjectInfo" resultType="ProjectInfo">
        SELECT *
        FROM sel_ProjectInfo
        WHERE CId = #{Cid} AND PState BETWEEN #{startState} AND #{endState}
    </select>
    <select id="sel_OneProjectDetail" parameterType="ProjectInfo" resultType="ProjectInfo">
        SELECT * FROM sel_ProjectInfo WHERE PId = #{PId}
    </select>
    <select id="sel_getAllOPProject" parameterType="Login" resultType="ProjectInfoPersonalOriented">
        SELECT * FROM sel_ProjectInfoPO WHERE UUuid = #{UUuid} AND PState BETWEEN #{startState} AND #{endState}
    </select>
    <select id="sel_getAllCommityMemL" parameterType="CommityInfo" resultType="UserExtend">
        SELECT UNackName,USex,UBIrthday,UTag,USign,UHeadImg,UUuid FROM sel_CommityMemList WHERE CId = #{Cid}
    </select>
    <select id="sel_AllUWorkByUuid" parameterType="Login" resultType="UserExtend">
        SELECT * FROM userworkview WHERE UUuid = #{UUuid}
    </select>
    <select id="sel_getPersonalInfoOne" parameterType="Login" resultType="PersonalInfoPersonalOriented">
        SELECT * FROM sel_PersonalInfoPO WHERE UUuid = #{UUuid}
    </select>
</mapper>